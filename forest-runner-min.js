var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,d=[];!(b=a.next()).done;)d.push(b.value);return d};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var d=$jscomp.propertyToPolyfillSymbol[b];if(null==d)return a[b];d=a[d];return void 0!==d?d:a[b]};
$jscomp.polyfill=function(a,b,d,e){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,d,e):$jscomp.polyfillUnisolated(a,b,d,e))};$jscomp.polyfillUnisolated=function(a,b,d,e){d=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var f=a[e];if(!(f in d))return;d=d[f]}a=a[a.length-1];e=d[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,d,e){var f=a.split(".");a=1===f.length;e=f[0];e=!a&&e in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var g=0;g<f.length-1;g++){var h=f[g];if(!(h in e))return;e=e[h]}f=f[f.length-1];d=$jscomp.IS_SYMBOL_NATIVE&&"es6"===d?e[f]:null;b=b(d);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,f,{configurable:!0,writable:!0,value:b}):b!==d&&(void 0===$jscomp.propertyToPolyfillSymbol[f]&&(d=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[f]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(f):$jscomp.POLYFILL_PREFIX+d+"$"+f),$jscomp.defineProperty(e,$jscomp.propertyToPolyfillSymbol[f],{configurable:!0,writable:!0,value:b})))};
$jscomp.getConstructImplementation=function(){function a(){function d(){}new d;Reflect.construct(d,[],function(){});return new d instanceof d}if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(a())return Reflect.construct;var b=Reflect.construct;return function(d,e,f){d=b(d,e);f&&Reflect.setPrototypeOf(d,f.prototype);return d}}return function(d,e,f){void 0===f&&(f=d);f=$jscomp.objectCreate(f.prototype||Object.prototype);return Function.prototype.apply.call(d,f,e)||
f}};$jscomp.construct={valueOf:$jscomp.getConstructImplementation}.valueOf();$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(d){}return!1};$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var d=$jscomp.setPrototypeOf;d(a,b)}else for(d in b)if("prototype"!=d)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d];a.superClass_=b.prototype};$jscomp.polyfill("Reflect",function(a){return a?a:{}},"es6","es3");$jscomp.polyfill("Reflect.construct",function(a){return $jscomp.construct},"es6","es3");
$jscomp.polyfill("Reflect.setPrototypeOf",function(a){if(a)return a;if($jscomp.setPrototypeOf){var b=$jscomp.setPrototypeOf;return function(d,e){try{return b(d,e),!0}catch(f){return!1}}}return null},"es6","es5");var canvas=document.getElementById("canv"),c=canvas.getContext("2d"),width=canvas.width,height=canvas.height,touchX=500,touchY=500,scaleFitNative=Math.max(width/1E3,height/1E3);window.onload=function(){setCanvasScale();startGame()};
function startGame(){setCanvasScale();start();atMainMenu=!1}window.addEventListener("resize",function(){setCanvasScale()});function engineUpdate(){getDeltaTime();deadScreen||(update(),render(),fading&&fadeOut("black"));requestAnimationFrame(engineUpdate)}function setColor(a){c.fillStyle=a}function fillRect(a,b,d,e){c.fillRect(a*scaleFitNative,b*scaleFitNative,d*scaleFitNative,e*scaleFitNative)}
function fillText(a,b,d,e,f,g){c.font=e*scaleFitNative+"px "+g;setColor(f);c.fillText(a,b*scaleFitNative,d*scaleFitNative)}function drawImg(a,b,d,e,f){c.drawImage(a,b*scaleFitNative,d*scaleFitNative,e*scaleFitNative,f*scaleFitNative)}function drawTriangle(a,b,d,e,f,g){drawLine(a,b,d,e);drawLine(d,e,f,g);drawLine(f,g,a,b)}function background(a){c.drawImage(a,0,0,width,height)}function translate(a,b){c.translate(a*scaleFitNative,b*scaleFitNative)}function setOpacity(a){c.globalAlpha=a}
function drawLine(a,b,d,e){c.beginPath();c.moveTo(a*scaleFitNative,b*scaleFitNative);c.lineTo(d*scaleFitNative,e*scaleFitNative);c.stroke();c.closePath()}function moveTo(a,b){c.moveTo(a*scaleFitNative,b*scaleFitNative)}function lineTo(a,b){c.lineTo(a*scaleFitNative,b*scaleFitNative)}
function setCanvasScale(){width=canvas.width=window.innerWidth;height=canvas.height=window.innerHeight;c.webkitImageSmoothingEnabled=!1;c.mozImageSmoothingEnabled=!1;c.imageSmoothingEnabled=!1;scaleFitNative=Math.max(width/1E3,height/1E3)}function toRadians(a){return Math.PI/180*a}function random(a,b){return Math.floor(Math.random()*(b-a)+a)}var flashOp=0,flashing=!1;
function flashScreen(a){setColor(a);.3>flashOp&&flashing?flashOp+=.02*deltaTime:(flashing=!1,dead&&(flashOp+=.02*deltaTime));!flashing&&.02<flashOp&&!dead&&(flashOp-=.02*deltaTime);c.globalAlpha=flashOp;fillRect(0,0,1E3,1E3);c.globalAlpha=1}var fadeFlashOp=0,fading=!1;function fadeOut(a){setColor(a);fadeFlashOp+=.05*deltaTime;c.globalAlpha=fadeFlashOp;fillRect(0,0,1E3,1E3);c.globalAlpha=1}var deltaTime,dlastcalledtime=Date.now();
function getDeltaTime(){deltaTime=(Date.now()-dlastcalledtime)/10;dlastcalledtime=Date.now()}function cos(a){return Math.cos(a)}function sin(a){return Math.sin(a)}function connect(a,b){drawLine(a.x-camera.x,a.y-camera.y,b.x-camera.x,b.y-camera.y)};var entities=[],dead=!1,deadScreen=!1,horizonY=260,score=0,gameSpeed=5;function start(){loadImages();loadAudio();startMainMenu()}function render(){setColor("skyblue");fillRect(0,0,1E3,1E3);setColor("rgb(72, 128, 29)");fillRect(0,horizonY,1E3,1E3);for(var a=0;a<entities.length;a++)entities[a].render();fillText("Score: "+score,30,30,20,"black","Arial")}
function update(){for(var a=0;a<entities.length;a++)entities[a].update(),entities[a].collide(),camera.z-800>entities[a].z&&entities.splice(a,1);entities.sort(function(b,d){return d.z-b.z});gameSpeed+=.007;camera.zSpeed=gameSpeed;camera.z+=camera.zSpeed*deltaTime;camera.x+=camera.xSpeed*deltaTime;-500>=camera.x&&(camera.x=-500);500<=camera.x&&(camera.x=500);dead&&(camera.zSpeed=0,camera.y+=deltaTime,horizonY-=deltaTime/4)}function updateScore(){score++;dead||setTimeout(updateScore,500)};var camera={x:0,y:30,z:0,xSpeed:0,zSpeed:0};var Entity=function(a,b,d,e,f,g){this.x=a;this.y=b;this.z=d;this.w=e;this.h=f;this.rs=this.ry=this.rx=0;this.img=g};Entity.prototype.render=function(){drawImg(this.img,this.rx,this.ry,this.rs*this.w,this.rs*this.h)};Entity.prototype.update=function(){this.rs=800/(800+this.z-camera.z);this.rx=(this.x-camera.x)*this.rs+500;this.ry=(this.y-camera.y)*this.rs+250};
Entity.prototype.collide=function(){10!=this.h&&camera.z-750>this.z&&500<this.rx+this.rs*this.w&&500>this.rx&&(hitSound.play(),fading=dead=!0,.1<song.volume&&(song.volume-=.1),setTimeout(startDeadMenu,500))};var Tree=function(a,b,d){Entity.call(this,a,b,d,50,150,treeImg)};$jscomp.inherits(Tree,Entity);function spawnEntities(){for(var a=0;3>a;a++)entities.push(new Tree(random(-500,500),-70,camera.z+3E3));for(a=0;3>a;a++)entities.push(new Tree(random(-500,-1E3),-70,camera.z+3E3));for(a=0;3>a;a++)entities.push(new Tree(random(500,1E3),-70,camera.z+3E3));entities.push(new Grass(0,70,camera.z+3E3));entities.push(new Grass(-1E3,70,camera.z+3E3));setTimeout(spawnEntities,1/(.3*gameSpeed)*400)};var Grass=function(a,b,d){Entity.call(this,a,b,d,1E3,10,grassImg)};$jscomp.inherits(Grass,Entity);var treeImg,menuImg,rockImg,grassImg,cursorImg;function loadImages(){treeImg=new Image;menuImg=new Image;rockImg=new Image;grassImg=new Image;cursorImg=new Image;treeImg.src="data/textures/tree.png";menuImg.src="data/textures/menu.png";rockImg.src="data/textures/rock.png";grassImg.src="data/textures/grass.png";cursorImg.src="data/textures/cursor.png"};var song,hitSound;function loadAudio(){hitSound=new Audio("data/audio/hit.wav");song=new Audio("data/audio/song.wav");song.volume=.3;song.currentTime=5;song.addEventListener("timeupdate",function(){18.7<this.currentTime&&(this.currentTime=9.7,this.play())})};var spawning=!1;function keyDown(a){switch(a.code){case "KeyD":camera.xSpeed=5;break;case "KeyA":camera.xSpeed=-5}}function keyUp(a){switch(a.code){case "KeyD":case "KeyA":camera.xSpeed=0}}document.onkeydown=keyDown;document.onkeyup=keyUp;var mouseX,mouseY,mouseDown;window.addEventListener("mousedown",function(a){mouseDown=!0;mouseX=a.clientX;mouseY=a.clientY});window.addEventListener("mousemove",function(a){mouseX=a.clientX;mouseY=a.clientY});window.addEventListener("mouseup",function(a){mouseDown=!1});var playing=!1,playButton,tutorialButton;function startMainMenu(){playButton=new Button(500,200,100,50,"blue","Play");tutorialButton=new Button(500,300,100,50,"blue","Tutorial");updateMainMenu()}
function renderMainMenu(){drawImg(menuImg,0,0,1E3,700);setColor("rgb(72, 128, 29)");fillRect(0,700,1E3,300);setOpacity(.3);setColor("gray");fillRect(0,0,1E3,1E3);setOpacity(1);fillText("Forest Runner",310,100,100,"green","Amatic SC");playButton.render();tutorialButton.render();c.drawImage(cursorImg,mouseX,mouseY,30,30)}
function updateMainMenu(){if(playButton.clicked()){playing=!0;entities=[];camera.zSpeed=5;if(!spawning){for(var a=0;15>a;a++)entities.push(new Tree(random(-500,500),-70,200*a));spawnEntities();spawning=!0;updateScore();song.play()}engineUpdate()}tutorialButton.clicked()&&startTutorial();renderMainMenu();playing||requestAnimationFrame(updateMainMenu)};var restartButton;function startDeadMenu(){restartButton=new Button(500,200,100,50,"blue","Restart");.1<song.volume&&(song.volume-=.1);song.pause();deadScreen=!0;updateDeadMenu()}
function renderDeadMenu(){drawImg(menuImg,0,0,1E3,700);setColor("rgb(72, 128, 29)");fillRect(0,700,1E3,300);setOpacity(.1);setColor("red");fillRect(0,0,1E3,1E3);setOpacity(1);fillText("Game Over",370,70,80,"red","Amatic SC");fillText("Score: "+score,465,100,30,"black","Amatic SC");restartButton.render();c.drawImage(cursorImg,mouseX,mouseY,30,30)}function updateDeadMenu(){restartButton.clicked()&&(location.href=location.href);renderDeadMenu();requestAnimationFrame(updateDeadMenu)};var started=!1;
function startTutorial(){started||(document.write("<h1>Game</h1><p>The goal of the game is to survive as long as possible. Dodge the trees as you run past them. Hit a tree and its game over. You will move faster as the game goes on.</p><h1>Controls</h1><p>Use the 'A' and 'D' keys on your keyboard to strafe side to side</p><button onclick='location.reload();'>Back to main menu</button><style>h1 {font-family: Arial; font-size: 50px}p {font-family: Arial; font-size: 30px}body {background-image: url('data/textures/menu.png')}button {width: 200px; height: 50px; border: none; background-color: blue; color: white; font-family: Arial; font-size: 20px}</style>"),started=
!0)};var Button=function(a,b,d,e,f,g){this.x=a;this.y=b;this.w=d;this.h=e;this.text=g;this.color=f;this.fontSize=300/(1.6*this.text.length)};Button.prototype.render=function(){setColor(this.color);fillRect(this.x+-this.w/2,this.y+-this.h/2,this.w,this.h);fillText(this.text,this.x-this.w/2+this.fontSize/6.5,this.y+this.h/4,this.fontSize,"white","Arial")};
Button.prototype.clicked=function(){if(mouseX>(this.x+-this.w/2)*scaleFitNative&&mouseX<(this.x+-this.w/2)*scaleFitNative+this.w*scaleFitNative&&mouseDown&&mouseY>(this.y+-this.h/2)*scaleFitNative&&mouseY<(this.y+-this.h/2)*scaleFitNative+this.h*scaleFitNative)return!0};
